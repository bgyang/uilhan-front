# 기능개선건

## 마진율 설정 (2023-10-26 ~ 2023-11-02) 

### 데이터구조
```json
{
  // 환율
  "rate":{
    "is_real_rate": true, // 실시간환율(true),고정환율(false) 여부
    "rate_value": "160" // 고정환율일 경우 환율값
  },
  
  // 마진
  "margin": {
    "is_auto_setting":true, // 자동설정(true),수동설정(false) 여부
    
    // 수동설정일 경우
    "margin_data": {
      "margin_value": 1.4, // 수동설정일 경우 마진값
      "card_charge": 1.06, // 수동설정일 경우 카드수수료
      "min_margin": 5000, // 수동설정일 경우 최소마진 
      "overseas_shipping_fee": 5000 // 수동설정일 경우 해외배송비
    }
  },
  
  // 마진가중치
  "margin_weight": {
    "is_use": true, // 사용(true),미사용(false) 여부
    
    // 마켓별 마진가중치
    "markets": {
      "coupang": 6,
      "smartstore": 13,
      "sk11st": 10
    }
  }
}
```
### 상품등록
- 상품등록시 `환율 설정`,`마진 설정`,`마진가중치 설정` 을 참조하여 `판매가`를 자동으로 계산하여 저장
- 상품등록시 공식: `원가 * 환율 * (추가값1 (카드 수수료 ) + 퍼센트 마진) + 추가값2 (최소마진) + 해외배송비`

### 상품상세
- 상품상세 기본정보 `배송비`를 `옵션정보` 판매마진,권장가,환율 위치로 옮김
- 배송비 설정시 실시간으로 운임계산하여 보여줌, DB저장 필요 없음
- 옵션정보에서 판매마진,권장가,환율 설정 삭제
- 옵션정보에서 옵션리스트의 `해외운임`,`권장가`삭제

## 도매꾹 신청서 등록 (2023-11-03 ~ 2023-11-09)
1. 배대지 회원ID 바인딩,및 회원동시가입
2. 구매대행 신청서 등록
3. 구매대행 신청서 상태 조회
4. 개인통관번호 체크
5. 통관품목 리스트조회

### 구매대행
- 구매대행 신청서 등록
  - 물류 센터 `칭다오,인천`
  - 배송 방법 `해운,항공`
  - 받는 사람 `한글,영어`
  - 개인통관고유부호  통관번호확인 `필수`
  - 통관 방법 `목록통관,사업자통관,일반통관(개인통관고유번호 필수)`
  - 주소 및 연락처 `연락처,우편번호,도로명주소,영문주소`
  - 배송 요청사항
  - 이미지 [품목이미지]
  - 판매번호 [타우보 상품번호]
  - 쇼핑몰 구매주문 번호 [타우보 주문번호]
  - 트래킹번호 [타우보 송장번호]
  - 통관품목 [고시정보]
  - 상품명 `영문,중문` 배대지에서는 통관품목 선택하면 자동으로 기입됨
  - 단가 `단가,수량`
  - 옵션 `색상,사이즈`
  - 상품 URL [타우보 상품URL]
  - 이미지 URL [타우보 상품이미지URL]
  - 요청사항
### 배송대행
이용자가 직접 구매진행후 배송대행 신청서 등록
- 배송대행 신청서 등록


## 쿠팡 반품배송비 설정기능 (2023-11-10 ~ 2023-11-12)
### 마켓계정관리(쿠팡) 반품비(편도) 상품가격 기준 설정기능
### 상품관리 무료배송체크박스
### 상품전송시 상품가격 기준 반품배송비 설정


## 티몬 (2023-11-27 ~ 2023-12-10)

### 마켓계정관리(티몬) 추가
#### 항목
- 파트너 ID
- 파트너 토큰
- client ID
- client secret


### 배송템플릿 규칙
- 마켓계정 관리에서 배송템플릿 필수필드 입력(제주 추가 배송비, 반품배송비,배송지 주소, 교환/반품지 주소) 입력하게 함
- 상품 등록시 주소지 API를 조회 하여 반품배송비로 설정한 배송지혹은 교환/반품지가 있는지 확인하여 있으면 사용 없으면 등록후 사용
- 배송템플릿 API를 조회 하여 무료배송정책에서 반품배송비와 마켓계정에서 설정한 반품배송비를 비교 하여 있으면 사용 없으면 등록후 사용


### 상품
#### 상품등록
- * `vendorDealNo`: 딜번호(티몬전시단위)에 해당 연동업체측 키 `O`
- * `vendorPolicyNo`: 티몬 오퍼레이터를 통해 받은 정책번호 `O`
- * `deliveryTemplateNo`: 배송템플릿번호 (계정정보에서 수집한 배송템플릿번호)`O`
- * `productType`:배송상품 유형 타입 (계정정보에서 수집한 정보)`O`
- `sections`: 상품선택정보들`X`
- * `managedTitle`: 티몬 내부에서 관리될 딜이름 `O`
- `salesStartDate`: 판매시작일 `X`
- `salesEndDate`: 판매종료일 `X`
- * `categoryNo`: 카테고리번호 `O`
- `subcategoryNos`: 서브카테고리번호 `X`
- * `legalPermissionType`: 법적허가유형 `V` 가전·컴퓨터, 뷰티, 생활·주방, 식품·건강, 출산·유아동 카테고리의 경우 필수
- * `importAdvertisementCertificate`: 광고심의필증 `V` 법적허가/신고대상 상품인 경우 필수, Full Url
- `maxPurchaseQty`: 최대구매수량 `X` 999
- `purchaseResetPeriod`: 구매수량 초기화 주기 `X` 7
- `adultOnly`: 성인상품여부 `X` false
- * `title`: 상품명 `O` 
- * `titleDecoration`: 판매용 제목 상단 홍보 문구(딜 홍보 문구) `O`
- * `mainImages`: 메인이미지 `O` 720X758(200kb), 동일이미지 등록 불가
- `homeRecommendedImages`: 홈추천이미지 `X` 756X383(200kb) 앱 메인 특정 영역에 노출되는 이벤트성 이미지
- `dealMainVideo`: 메인동영상 `X`
- * `detailContents`: 사이트 노출용 딜상세 내용 `O`
- `additionalInput`: 추가입력사항 `X`
- `additionalInputTitle`: 주문시 입력받을 부가정보 `X`
- `originCountryType`: 원산지 표기 방식 `V` '식품·건강(52000000)', '해외직구>식품·건강(74030000)' 카테고리 선택시 필수
- `originCountryDetail`: 원산지 상세 `V` 표기방식이 "직접입력"일 때 필수
- `originCountryCode`: 원산지 코드 `V` 표기방식이 "수입산"일 때 필수
- * `productInfos`: 상품정보제공고시 정보들 `O`
- * `kcAuthSubmitType`: KC인증 제출 유형 `O`
- `kcAuths`: KC인증들 `V` 제출타입일 경우 필수
- `deliveryCorp`: 택배사 `X`
- `search`: 검색 노출 여부 `X` true
- `keywords`: 검색 키워드 `X` 최대 5개까지 입력가능.,키워드 하나에 최대 19자까지 입력 가능.키워드 구분은 띄어쓰기로 가능.
- `priceComparison`: 가격비교사이트 노출 여부 `X` true
- `dealProductStatus`: 상품상태 메타정보 `X` NEW(신상품)
- `dealSellMethod`: 판매방식 메타정보 `X`
- * `useCustomsIdNo`: 주문 시, 개인통관고유번호 입력유무 `X` productType이 해외직배송(DP02), 해외구매대행(DP03)일 경우 true로 필수, 등록이후 수정불가
- `mainDealOptionNo`: 대표 가격으로 설정될 메인 딜옵션 번호 `X`
- `parallelImport`: 병행수입 여부 `X` false
- `importDeclarationCertificate`: 수입신고필증 `V` 병행수입 상품인 경우 필수, Full Url
- `distanceFeeGradeUsing`: 지역별 차등배송비 사용여부 `X` false
- `distanceFeeGradeContents`: 지역별 차등배송비 또는 사유 `V` 지역별차등배송비를 사용하는 경우 필수입력
- `extraInstallationCostUsing`: 추가설치비 사용여부 `X` false
- `simpleRefundAble`: 단순변심환불 가능 여부 `X` true 상품유형에 따라 불가능으로 설정 불가, 등록이후 수정불가
- `simpleRefundNotAvailableReason`: 단순변심환불 불가능 사유 `V` 단순변심 환불 불가능으로 설정시 필수 입력
- `brandName`: 브랜드명 `X`
- * `dealOptions`: 딜옵션들 `O`

> - (*) 필수항목
> - V 조건부 필수
> -  상품등록API에서 옵션이미지 등록시 따로 API요청해야 하는지 확인필요 

확인사항
- kc인증 [Y(제출), N(대상아님), X(컨텐츠에포함)] 3가지 유형이 있고 Y일 경우 kcAuths 필수
- 법적허가/신고대상 상품코드.  가전·컴퓨터, 뷰티, 생활·주방, 식품·건강, 출산·유아동 카테고리의 경우 필수
- 광고심의필증. 법적허가/신고대상 상품인 경우 필수

### 주문
 - 주문수집
 - 주문, 발주,배송처리